<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.87.0">
    <title>Laucher Web</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/navbar-static/">
    <link href="{{ url_for('static', filename='css/bootstrap.css') }}" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
      .abc { caption-side: top; }
          @media (min-width: 768px) {
           .bd-placeholder-img-lg {
            font-size: 3.5rem;
            }
       }


    </style>
    <!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename='css/navbar-top.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>


</head>
<body>
{%with messages = get_flashed_messages()%}
{%if messages %}
<script type="text/javascript">
      alert("{{messages[-1]}}");

</script>
{%endif%}
{%endwith%}
{% include 'html/nav.html' %}


<div class="container-xl">
    <div class="row ">
        <div class="col-sm ">
            <table class="table table-hover">
                <caption class="abc">관리자 관리</caption>
                <thead>
                <tr class="table-success">
                    <th scope="col">관리자 이름</th>
                    <th scope="col">관리</th>
                </tr>
                </thead>
                <tbody>
                {% for admin_name in admin %}
                <tr>
                    <th scope="row">{{admin_name}}</th>
                    <th>
                        <button class="btn btn-secondary btn-sm btn-danger" type="button"
                                onclick="admin_del('{{admin_name}}');">
                            삭제
                        </button>
                    </th>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <button class="btn btn-secondary btn-sm btn-success" data-toggle="modal" data-target=".admin_add"
                    type="button">추가
            </button>

        </div>


        <div class="col-sm ">
            <table class="table table-hover">
                <caption class="abc">가입 멤버 가능 관리</caption>
                <thead>
                <tr class="table-success">
                    <th scope="col">가입 가능 멤버</th>
                    <th scope="col">관리</th>
                </tr>
                </thead>
                <tbody>
                {% for permit_name in permit %}
                <tr>
                    <th scope="row">{{permit_name}}</th>
                    <th>
                        <button class="btn btn-secondary btn-sm btn-danger" type="button"
                                onclick="permit_del('{{permit_name}}')">
                            삭제
                        </button>
                    </th>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <button class="btn btn-secondary btn-sm btn-success" data-toggle="modal" data-target=".permit_add"
                    type="button">추가
            </button>

        </div>

        <div class="col-sm ">
            <table class="table table-hover">
                <caption class="abc">가입 된 멤버 관리</caption>
                <thead>
                <tr class="table-success">
                    <th scope="col">가입 멤버 이름</th>
                    <th scope="col">가입 멤버 아이디</th>
                    <th scope="col">관리</th>
                </tr>
                </thead>
                <tbody>
                {% for register_ in register %}
                <tr>
                    <th scope="row">{{register_[0]}}</th>
                    <th scope="row">{{register_[1]}}</th>
                    <th>
                        <button class="btn btn-secondary btn-sm btn-danger" type="button"
                                onclick="member_del('{{register_[0]}}');">
                            삭제
                        </button>
                    </th>
                </tr>
                {% endfor %}

                </tbody>
            </table>


        </div>
    </div>
</div>
</div>


<div class="modal fade admin_add" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">관리자 추가</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">

                <form>
                    <div class="form-group">
                        <label class="col-form-label">관리자 이름</label>
                        <input type="text" class="form-control" id="add_admin">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="addadmin();">추가</button>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>
<div class="modal fade permit_add" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">가입 권한 멤버 추가</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">

                <form>
                    <div class="form-group">
                        <label class="col-form-label">추가 멤버 이름</label>
                        <input type="text" class="form-control" id="add_permit">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="addpermit();">추가</button>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>

<script>
    function admin_del(name){
        var check_string = "해당 멤버를 정말 삭제하시겠어요?"
        if(!confirm(check_string)){
            return false
        }
        $.ajax({
            url: "/admin?type=1&name="+name,
            type: "DELETE",
            dataType: "text",
            success: function(data){
                alert("삭제 되었습니다.")
                window.location.reload()
            }
        });
    }


function addadmin(){
    const name = document.getElementById('add_admin').value;
    $.ajax({
            url: "/admin",
            type: "POST",
            data: {
                type : 1,
                name:name
            },
            dataType:'JSON',
            success: function(data){
                alert("추가 되었습니다.")
                window.location.reload()
            }

    });
}

function addpermit(){
    const name = document.getElementById('add_permit').value;
    $.ajax({
            url: "/admin",
            type: "POST",
            data: {
                type : 2,
                name:name
            },
            dataType:'JSON',
            success: function(data){
                alert("추가 되었습니다.")
                window.location.reload()
            }
    });
}
function permit_del(name){
   var check_string = "해당 멤버를 정말 삭제하시겠어요?"
    if(!confirm(check_string)){
        return false
    }
    $.ajax({
        url: "/admin?type=2&name="+name,
        type: "DELETE",
        dataType: "text",
        success: function(data){
            alert("삭제 되었습니다.")
            window.location.reload()
        }
    });
}
function member_del(name){
   var check_string = "해당 멤버를 정말 삭제하시겠어요?"
    if(!confirm(check_string)){
        return false
    }
    $.ajax({
        url: "/admin?type=3&name="+name,
        type: "DELETE",
        dataType: "text",
        success: function(data){
            alert("삭제 되었습니다.")
            window.location.reload()
        }
    });
}








</script>
</body>
</html>